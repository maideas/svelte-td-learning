var app=function(e){"use strict";function t(){}function n(e,t){for(const n in t)e[n]=t[n];return e}function u(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(u)}function l(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function o(e){return null==e?"":e}function c(e,t){e.appendChild(t)}function d(e,t,n){e.insertBefore(t,n||null)}function m(e){e.parentNode.removeChild(e)}function g(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function p(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function h(e){return document.createTextNode(e)}function $(){return h(" ")}function x(){return h("")}function y(e,t,n,u){return e.addEventListener(t,n,u),()=>e.removeEventListener(t,n,u)}function Q(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function N(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function v(e,t,n,u){e.style.setProperty(t,n,u?"important":"")}function A(e,t){for(let n=0;n<e.options.length;n+=1){const u=e.options[n];if(u.__value===t)return void(u.selected=!0)}}function w(e,t,n){e.classList[n?"add":"remove"](t)}let S;function b(e){S=e}function Y(){if(!S)throw new Error("Function called outside component initialization");return S}function X(e){Y().$$.on_mount.push(e)}function k(){const e=Y();return(t,n)=>{const u=e.$$.callbacks[t];if(u){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);u.slice().forEach((t=>{t.call(e,r)}))}}}function F(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const E=[],D=[],R=[],V=[],M=Promise.resolve();let T=!1;function B(e){R.push(e)}function _(e){V.push(e)}let z=!1;const C=new Set;function I(){if(!z){z=!0;do{for(let e=0;e<E.length;e+=1){const t=E[e];b(t),j(t.$$)}for(b(null),E.length=0;D.length;)D.pop()();for(let e=0;e<R.length;e+=1){const t=R[e];C.has(t)||(C.add(t),t())}R.length=0}while(E.length);for(;V.length;)V.pop()();T=!1,z=!1,C.clear()}}function j(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(B)}}const L=new Set;let P;function G(){P={r:0,c:[],p:P}}function O(){P.r||s(P.c),P=P.p}function q(e,t){e&&e.i&&(L.delete(e),e.i(t))}function H(e,t,n,u){if(e&&e.o){if(L.has(e))return;L.add(e),P.c.push((()=>{L.delete(e),u&&(n&&e.d(1),u())})),e.o(t)}}function J(e,t,n){const u=e.$$.props[t];void 0!==u&&(e.$$.bound[u]=n,n(e.$$.ctx[u]))}function K(e){e&&e.c()}function U(e,t,n){const{fragment:r,on_mount:i,on_destroy:a,after_update:o}=e.$$;r&&r.m(t,n),B((()=>{const t=i.map(u).filter(l);a?a.push(...t):s(t),e.$$.on_mount=[]})),o.forEach(B)}function W(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,t){-1===e.$$.dirty[0]&&(E.push(e),T||(T=!0,M.then(I)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ee(e,n,u,l,i,a,o=[-1]){const c=S;b(e);const d=n.props||{},g=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:[]),callbacks:r(),dirty:o,skip_bound:!1};let f=!1;if(g.ctx=u?u(e,d,((t,n,...u)=>{const r=u.length?u[0]:n;return g.ctx&&i(g.ctx[t],g.ctx[t]=r)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](r),f&&Z(e,t)),n})):[],g.update(),f=!0,s(g.before_update),g.fragment=!!l&&l(g.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);g.fragment&&g.fragment.l(e),e.forEach(m)}else g.fragment&&g.fragment.c();n.intro&&q(e.$$.fragment),U(e,n.target,n.anchor),I()}b(c)}class te{$destroy(){W(this,1),this.$destroy=t}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ne(e){let n,u,r;return{c(){n=p("svg"),u=p("path"),Q(u,"fill","currentColor"),Q(u,"d",e[0]),Q(n,"aria-hidden","true"),Q(n,"class",r=o(e[1])+" svelte-1d15yci"),Q(n,"role","img"),Q(n,"xmlns","http://www.w3.org/2000/svg"),Q(n,"viewBox",e[2])},m(e,t){d(e,n,t),c(n,u)},p(e,[t]){1&t&&Q(u,"d",e[0]),2&t&&r!==(r=o(e[1])+" svelte-1d15yci")&&Q(n,"class",r),4&t&&Q(n,"viewBox",e[2])},i:t,o:t,d(e){e&&m(n)}}}function ue(e,t,u){let{icon:r}=t,s=[],l="",i="";return e.$$set=e=>{u(4,t=n(n({},t),a(e))),"icon"in e&&u(3,r=e.icon)},e.$$.update=()=>{8&e.$$.dirty&&u(2,i="0 0 "+r.icon[0]+" "+r.icon[1]),u(1,l="fa-svelte "+(t.class?t.class:"")),8&e.$$.dirty&&u(0,s=r.icon[4])},t=a(t),[s,l,i,r]}class re extends te{constructor(e){super(),ee(this,e,ue,ne,i,{icon:3})}}
/*!
     * Font Awesome Free 5.15.1 by @fontawesome - https://fontawesome.com
     * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
     */var se={prefix:"far",iconName:"arrow-alt-circle-up",icon:[512,512,[],"f35b","M256 504c137 0 248-111 248-248S393 8 256 8 8 119 8 256s111 248 248 248zm0-448c110.5 0 200 89.5 200 200s-89.5 200-200 200S56 366.5 56 256 145.5 56 256 56zm20 328h-40c-6.6 0-12-5.4-12-12V256h-67c-10.7 0-16-12.9-8.5-20.5l99-99c4.7-4.7 12.3-4.7 17 0l99 99c7.6 7.6 2.2 20.5-8.5 20.5h-67v116c0 6.6-5.4 12-12 12z"]};function le(e){let t,n,u=e[2].toFixed()+"";return{c(){t=f("span"),n=h(u),Q(t,"class","svelte-6n71zn")},m(e,u){d(e,t,u),c(t,n)},p(e,t){4&t&&u!==(u=e[2].toFixed()+"")&&N(n,u)},d(e){e&&m(t)}}}function ie(e){let t,n,u=e[2].toFixed(1)+"";return{c(){t=f("span"),n=h(u),Q(t,"class","svelte-6n71zn")},m(e,u){d(e,t,u),c(t,n)},p(e,t){4&t&&u!==(u=e[2].toFixed(1)+"")&&N(n,u)},d(e){e&&m(t)}}}function ae(e){let t,n,u;return n=new re({props:{icon:se}}),{c(){t=f("div"),K(n.$$.fragment),v(t,"font-size","32px"),v(t,"transform","rotate("+e[4]+"deg)"),Q(t,"class","svelte-6n71zn")},m(e,r){d(e,t,r),U(n,t,null),u=!0},p(e,n){(!u||16&n)&&v(t,"transform","rotate("+e[4]+"deg)")},i(e){u||(q(n.$$.fragment,e),u=!0)},o(e){H(n.$$.fragment,e),u=!1},d(e){e&&m(t),W(n)}}}function oe(e){let n;return{c(){n=h("terminal state")},m(e,t){d(e,n,t)},p:t,i:t,o:t,d(e){e&&m(n)}}}function ce(e){let n;return{c(){n=h("blocked")},m(e,t){d(e,n,t)},p:t,i:t,o:t,d(e){e&&m(n)}}}function de(e){let t,n,u,r,s,l,i,a,o,g,p,x,y,v,A,S,b,Y,X,k,F,E,D,R,V,M,T,B,_,z,C=e[3][me.up].toFixed(3)+"",I=e[3][me.left].toFixed(3)+"",j=e[3][me.right].toFixed(3)+"",L=e[3][me.down].toFixed(3)+"";function P(e,t){return(null==o||4&t)&&(o=!!(Math.abs(e[2])<10)),o?ie:le}let J=P(e,-1),K=J(e);const U=[ce,oe,ae],W=[];function Z(e,t){return e[0]?0:e[1]?1:2}return S=Z(e),b=W[S]=U[S](e),{c(){t=f("div"),n=f("div"),u=$(),r=f("div"),s=f("span"),l=h(C),i=$(),a=f("div"),K.c(),g=$(),p=f("div"),x=f("span"),y=h(I),v=$(),A=f("div"),b.c(),Y=$(),X=f("div"),k=f("span"),F=h(j),E=$(),D=f("div"),R=$(),V=f("div"),M=f("span"),T=h(L),B=$(),_=f("div"),Q(s,"class","svelte-6n71zn"),Q(r,"class","sub-tile sub-tile-top svelte-6n71zn"),Q(a,"class","sub-tile sub-tile-reward svelte-6n71zn"),w(a,"reward-is-negative",e[2]<0),Q(x,"class","svelte-6n71zn"),Q(p,"class","sub-tile sub-tile-left svelte-6n71zn"),Q(A,"class","sub-tile sub-tile-middle svelte-6n71zn"),Q(k,"class","svelte-6n71zn"),Q(X,"class","sub-tile sub-tile-right svelte-6n71zn"),Q(M,"class","svelte-6n71zn"),Q(V,"class","sub-tile sub-tile-bottom svelte-6n71zn"),Q(t,"class","tile svelte-6n71zn"),Q(t,"style",e[5]),w(t,"blocked",e[0]),w(t,"terminal",e[1])},m(e,o){d(e,t,o),c(t,n),c(t,u),c(t,r),c(r,s),c(s,l),c(t,i),c(t,a),K.m(a,null),c(t,g),c(t,p),c(p,x),c(x,y),c(t,v),c(t,A),W[S].m(A,null),c(t,Y),c(t,X),c(X,k),c(k,F),c(t,E),c(t,D),c(t,R),c(t,V),c(V,M),c(M,T),c(t,B),c(t,_),z=!0},p(e,[n]){(!z||8&n)&&C!==(C=e[3][me.up].toFixed(3)+"")&&N(l,C),J===(J=P(e,n))&&K?K.p(e,n):(K.d(1),K=J(e),K&&(K.c(),K.m(a,null))),4&n&&w(a,"reward-is-negative",e[2]<0),(!z||8&n)&&I!==(I=e[3][me.left].toFixed(3)+"")&&N(y,I);let u=S;S=Z(e),S===u?W[S].p(e,n):(G(),H(W[u],1,1,(()=>{W[u]=null})),O(),b=W[S],b?b.p(e,n):(b=W[S]=U[S](e),b.c()),q(b,1),b.m(A,null)),(!z||8&n)&&j!==(j=e[3][me.right].toFixed(3)+"")&&N(F,j),(!z||8&n)&&L!==(L=e[3][me.down].toFixed(3)+"")&&N(T,L),(!z||32&n)&&Q(t,"style",e[5]),1&n&&w(t,"blocked",e[0]),2&n&&w(t,"terminal",e[1])},i(e){z||(q(b),z=!0)},o(e){H(b),z=!1},d(e){e&&m(t),K.d(),W[S].d()}}}const me=Object.freeze({up:0,right:1,down:2,left:3});function ge(e,t,n){let u,r=!1,s=!1,l=0,i=Array.from({length:4},(()=>0)),a="";const o=()=>Math.max(...i);return[r,s,l,i,u,a,()=>r,()=>{n(0,r=!0)},()=>s,()=>{n(1,s=!0)},()=>l,e=>{n(2,l=e),s&&n(3,i=Array.from({length:4},(()=>e)))},o,e=>{s||r||(n(3,i=e),(()=>{let e=i.indexOf(o());n(4,u=(90*e).toFixed())})())},e=>{let t,u,s,l=.35+.6*e;r||(t=0+255*l,u=110+145*l,s=210+45*l,n(5,a="background: rgb("+t+","+u+","+s+", 1);"))}]}class fe extends te{constructor(e){super(),ee(this,e,ge,de,i,{isBlocked:6,setBlocked:7,isTerminal:8,setTerminal:9,getReward:10,setReward:11,getMaxQValue:12,setQValues:13,setHeat:14})}get isBlocked(){return this.$$.ctx[6]}get setBlocked(){return this.$$.ctx[7]}get isTerminal(){return this.$$.ctx[8]}get setTerminal(){return this.$$.ctx[9]}get getReward(){return this.$$.ctx[10]}get setReward(){return this.$$.ctx[11]}get getMaxQValue(){return this.$$.ctx[12]}get setQValues(){return this.$$.ctx[13]}get setHeat(){return this.$$.ctx[14]}}function pe(e,t,n){const u=e.slice();return u[16]=t[n],u[17]=t,u[18]=n,u}function he(e,t,n){const u=e.slice();return u[16]=t[n],u[19]=t,u[20]=n,u}function $e(e){let t,n,u=e[20],r=e[18];const s=()=>e[10](t,u,r),l=()=>e[10](null,u,r);return t=new fe({props:{}}),s(),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){u===e[20]&&r===e[18]||(l(),u=e[20],r=e[18],s());t.$set({})},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(e){l(),W(t,e)}}}function xe(e){let t,n,u=Array(e[0]),r=[];for(let t=0;t<u.length;t+=1)r[t]=$e(he(e,u,t));const s=e=>H(r[e],1,1,(()=>{r[e]=null}));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=x()},m(e,u){for(let t=0;t<r.length;t+=1)r[t].m(e,u);d(e,t,u),n=!0},p(e,n){if(5&n){let l;for(u=Array(e[0]),l=0;l<u.length;l+=1){const s=he(e,u,l);r[l]?(r[l].p(s,n),q(r[l],1)):(r[l]=$e(s),r[l].c(),q(r[l],1),r[l].m(t.parentNode,t))}for(G(),l=u.length;l<r.length;l+=1)s(l);O()}},i(e){if(!n){for(let e=0;e<u.length;e+=1)q(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)H(r[e]);n=!1},d(e){g(r,e),e&&m(t)}}}function ye(e){let t,n,u=Array(e[1]),r=[];for(let t=0;t<u.length;t+=1)r[t]=xe(pe(e,u,t));const s=e=>H(r[e],1,1,(()=>{r[e]=null}));return{c(){t=f("div");for(let e=0;e<r.length;e+=1)r[e].c();Q(t,"class","maze svelte-csffwp"),v(t,"grid-template-columns","repeat("+e[0]+", 100px)")},m(e,u){d(e,t,u);for(let e=0;e<r.length;e+=1)r[e].m(t,null);n=!0},p(e,[l]){if(7&l){let n;for(u=Array(e[1]),n=0;n<u.length;n+=1){const s=pe(e,u,n);r[n]?(r[n].p(s,l),q(r[n],1)):(r[n]=xe(s),r[n].c(),q(r[n],1),r[n].m(t,null))}for(G(),n=u.length;n<r.length;n+=1)s(n);O()}(!n||1&l)&&v(t,"grid-template-columns","repeat("+e[0]+", 100px)")},i(e){if(!n){for(let e=0;e<u.length;e+=1)q(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)H(r[e]);n=!1},d(e){e&&m(t),g(r,e)}}}function Qe(e,t,n){let{numX:u}=t,{numY:r}=t,{blocked:s=[]}=t,{terminal:l=[]}=t,{rewards:i=[]}=t,{defaultReward:a=0}=t,o=Array.from({length:u},(()=>Array.from({length:r},(()=>null))));X((()=>{s.forEach((e=>{o[e[0]][e[1]].setBlocked()})),l.forEach((e=>{o[e[0]][e[1]].setTerminal()}));for(let e=0;e<r;e++)for(let t=0;t<u;t++)o[t][e].setReward(a);i.forEach((e=>{o[e[0]][e[1]].setReward(e[2])}))}));const c=e=>o[e[0]][e[1]].isBlocked(),d=e=>o[e[0]][e[1]].isTerminal(),m=e=>o[e[0]][e[1]].getReward(),g=()=>{let e=1e6,t=-1e6;for(let n=0;n<r;n++)for(let r=0;r<u;r++){let u=o[r][n].getMaxQValue();e>u&&(e=u),t<u&&(t=u)}let n=t-e;for(let t=0;t<r;t++)for(let r=0;r<u;r++){let u=o[r][t].getMaxQValue();o[r][t].setHeat((u-e)/n)}},f=e=>Math.floor(Math.random()*Math.floor(e));return e.$$set=e=>{"numX"in e&&n(0,u=e.numX),"numY"in e&&n(1,r=e.numY),"blocked"in e&&n(3,s=e.blocked),"terminal"in e&&n(4,l=e.terminal),"rewards"in e&&n(5,i=e.rewards),"defaultReward"in e&&n(6,a=e.defaultReward)},[u,r,o,s,l,i,a,(e,t)=>{o[e[0]][e[1]].setQValues(t),g()},()=>{for(;;){let e=[f(u),f(r)];if(!d(e)&&!c(e))return e}},(e,t)=>{let n=[...e];return t==me.down&&e[1]<r-1&&(n[1]+=1),t==me.right&&e[0]<u-1&&(n[0]+=1),t==me.up&&e[1]>0&&(n[1]-=1),t==me.left&&e[0]>0&&(n[0]-=1),c(n)&&(n=[...e]),[n,m(n),d(n)]},function(e,t,u){D[e?"unshift":"push"]((()=>{o[t][u]=e,n(2,o)}))}]}class Ne extends te{constructor(e){super(),ee(this,e,Qe,ye,i,{numX:0,numY:1,blocked:3,terminal:4,rewards:5,defaultReward:6,setQValues:7,getRandomStartState:8,step:9})}get setQValues(){return this.$$.ctx[7]}get getRandomStartState(){return this.$$.ctx[8]}get step(){return this.$$.ctx[9]}}function ve(e){let n;return{c(){n=f("div"),Q(n,"class","plot svelte-1qi4jkb")},m(t,u){d(t,n,u),e[12](n)},p:t,i:t,o:t,d(t){t&&m(n),e[12](null)}}}function Ae(e,t,n){let u,{title:r=""}=t,{xIsLog:s=!1}=t,{data:l=[]}=t,{yIsLog:i=!1}=t,{yTitle:a=""}=t,{hasSecondY:o=!1}=t,{dataSecond:c=[]}=t,{ySecondIsLog:d=!1}=t,{ySecondTitle:m=""}=t;const g=()=>{let e=l.length?-.02*l.length:-.02,t=l.length?1.02*l.length:1.02,n={title:r,showlegend:!1,xaxis:{type:s?"log":"linear",range:[e,t]},yaxis:{title:a,type:i?"log":"linear",range:[-1.1,1.1],titlefont:{color:"#08C"},tickfont:{color:"#08C"},autorange:!0},margin:{autoexpand:!1,t:50,l:40,b:30,r:20}};""!=a&&(n.margin.l=60);let g=[{x:[...Array(l.length).keys()],y:l,mode:"lines",line:{shape:"spline"},type:"scatter"}];if(o){n.yaxis2={title:m,type:d?"log":"linear",range:[-1.1,1.1],overlaying:"y",side:"right",titlefont:{color:"#E60"},tickfont:{color:"#E60"},autorange:!0},n.margin.r=""!=m?60:40;let e={x:[...Array(c.length).keys()],y:c,mode:"lines",line:{shape:"spline"},type:"scatter",yaxis:"y2"};g.push(e)}Plotly.react(u,g,n,{displaylogo:!1})};return X((()=>{g()})),e.$$set=e=>{"title"in e&&n(3,r=e.title),"xIsLog"in e&&n(4,s=e.xIsLog),"data"in e&&n(1,l=e.data),"yIsLog"in e&&n(5,i=e.yIsLog),"yTitle"in e&&n(6,a=e.yTitle),"hasSecondY"in e&&n(7,o=e.hasSecondY),"dataSecond"in e&&n(2,c=e.dataSecond),"ySecondIsLog"in e&&n(8,d=e.ySecondIsLog),"ySecondTitle"in e&&n(9,m=e.ySecondTitle)},[u,l,c,r,s,i,a,o,d,m,g,()=>{n(1,l=[]),n(2,c=[]),g()},function(e){D[e?"unshift":"push"]((()=>{u=e,n(0,u)}))}]}class we extends te{constructor(e){super(),ee(this,e,Ae,ve,i,{title:3,xIsLog:4,data:1,yIsLog:5,yTitle:6,hasSecondY:7,dataSecond:2,ySecondIsLog:8,ySecondTitle:9,updatePlot:10,clearPlot:11})}get updatePlot(){return this.$$.ctx[10]}get clearPlot(){return this.$$.ctx[11]}}function Se(e,t,n){const u=k();let{numX:r}=t,{numY:s}=t,{numA:l}=t,i=Array.from({length:r},(()=>Array.from({length:s},(()=>null))));const a=()=>{for(let e=0;e<s;e++)for(let t=0;t<r;t++)i[t][e]=Array(l).fill().map((()=>Math.random()));u("modelChanged",{})};X((()=>{a()}));return e.$$set=e=>{"numX"in e&&n(0,r=e.numX),"numY"in e&&n(1,s=e.numY),"numA"in e&&n(2,l=e.numA)},[r,s,l,a,e=>{let t=e[0],n=e[1];return i[t][n]},(e,t)=>{let n=e.state[0],r=e.state[1],s=e.a;i[n][r][s]=t(e),u("modelChanged",{})}]}class be extends te{constructor(e){super(),ee(this,e,Se,null,i,{numX:0,numY:1,numA:2,init:3,predictState:4,updateModel:5})}get init(){return this.$$.ctx[3]}get predictState(){return this.$$.ctx[4]}get updateModel(){return this.$$.ctx[5]}}function Ye(e,t,n){let u=[],{maxData:r=1e3}=t;return e.$$set=e=>{"maxData"in e&&n(0,r=e.maxData)},[r,e=>{for(;u.length>=r;)u.shift();u.push(e)},e=>{let t=u.length;if(t<=e)return[...u];let n=new Array(e),r=new Array(t);for(;e--;){let s=Math.floor(Math.random()*t);n[e]=u[s in r?r[s]:s],r[s]=--t in r?r[t]:t}return n},()=>[...u],()=>{u=[]}]}class Xe extends te{constructor(e){super(),ee(this,e,Ye,null,i,{maxData:0,add:1,getBatch:2,getAll:3,clear:4})}get add(){return this.$$.ctx[1]}get getBatch(){return this.$$.ctx[2]}get getAll(){return this.$$.ctx[3]}get clear(){return this.$$.ctx[4]}}function ke(e){let t,n;return t=new Xe({props:{maxData:Fe}}),e[10](t),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,[n]){t.$set({})},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[10](null),W(t,n)}}}const Fe=2e3;function Ee(e,t,n){const u=k();let r,s,{numX:l}=t,{numY:i}=t,{numA:a}=t,{duelingQNet:o=!1}=t,{learningRate:c=.002}=t,{trainDistance:d=10}=t,m=0;class g extends tf.layers.Layer{constructor(){super({})}getClassName(){return"DuelingLayer"}computeOutputShape(e){return e[0]}call(e,t){return tf.tidy((()=>{const t=e[0],n=e[1];return t.sub(t.mean(1).reshape([-1,1])).add(n)}))}}const f=()=>{null!=r&&r.dispose(),o?(()=>{const e=tf.input({shape:[2]}),t=tf.layers.dense({units:10,useBias:!0,activation:"tanh"}).apply(e),n=tf.layers.dense({units:10,useBias:!0,activation:"tanh"}).apply(t),u=tf.layers.dense({units:10,useBias:!0,activation:"tanh"}).apply(n),s=tf.layers.dense({units:a,useBias:!0,activation:"linear"}).apply(u),l=tf.layers.dense({units:10,useBias:!0,activation:"tanh"}).apply(n),i=tf.layers.dense({units:1,useBias:!0,activation:"linear"}).apply(l),o=(new g).apply([s,i]);r=tf.model({inputs:e,outputs:o})})():(r=tf.sequential(),r.add(tf.layers.dense({inputShape:[2],units:10,useBias:!0,activation:"tanh"})),r.add(tf.layers.dense({units:10,useBias:!0,activation:"tanh"})),r.add(tf.layers.dense({units:10,useBias:!0,activation:"tanh"})),r.add(tf.layers.dense({units:a,useBias:!0,activation:"linear"}))),r.compile({optimizer:tf.train.adam(c),loss:"meanSquaredError",metrics:["accuracy"]})},p=e=>((e,t,n)=>{let u=[];return e.forEach(((e,r)=>{e-=(n[r]+t[r])/2,e/=(n[r]-t[r])/2,u.push(e)})),u})(e,[0,0],[l-1,i-1]),h=()=>{f(),s.clear(),u("modelChanged",{})};X((()=>{h()}));const $=e=>{let t;return tf.tidy((()=>{const n=tf.tensor2d(e,[e.length,e[0].length],"float32");t=r.predict(n).arraySync()})),t};return e.$$set=e=>{"numX"in e&&n(1,l=e.numX),"numY"in e&&n(2,i=e.numY),"numA"in e&&n(3,a=e.numA),"duelingQNet"in e&&n(4,o=e.duelingQNet),"learningRate"in e&&n(5,c=e.learningRate),"trainDistance"in e&&n(6,d=e.trainDistance)},[s,l,i,a,o,c,d,h,e=>$([p(e)])[0],async(e,t)=>{if(e.normState=p(e.state),s.add(e),m++,m<d)return;m=0;const n=s.getBatch(100);let l=[];n.forEach((e=>{l.push(e.normState)}));let i=$(l);n.forEach(((e,n)=>{i[n][e.a]=t(e)})),await(async(e,t)=>{const n=tf.tensor2d(e,[e.length,e[0].length],"float32"),u=tf.tensor2d(t,[t.length,t[0].length],"float32");await r.fit(n,u,{batchSize:e.length,epochs:10,shuffle:!0,callbacks:{}}),n.dispose(),u.dispose()})(l,i),u("modelChanged",{})},function(e){D[e?"unshift":"push"]((()=>{s=e,n(0,s)}))}]}class De extends te{constructor(e){super(),ee(this,e,Ee,ke,i,{numX:1,numY:2,numA:3,duelingQNet:4,learningRate:5,trainDistance:6,init:7,predictState:8,updateModel:9})}get init(){return this.$$.ctx[7]}get predictState(){return this.$$.ctx[8]}get updateModel(){return this.$$.ctx[9]}}function Re(e){let t,n,u={numX:e[0],numY:e[1],numA:e[2]};return t=new be({props:u}),e[18](t),t.$on("modelChanged",e[19]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){const u={};1&n&&(u.numX=e[0]),2&n&&(u.numY=e[1]),4&n&&(u.numA=e[2]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[18](null),W(t,n)}}}function Ve(e){let t,n,u={numX:e[0],numY:e[1],numA:e[2],duelingQNet:e[4],learningRate:e[5],trainDistance:e[6]};return t=new De({props:u}),e[16](t),t.$on("modelChanged",e[17]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){const u={};1&n&&(u.numX=e[0]),2&n&&(u.numY=e[1]),4&n&&(u.numA=e[2]),16&n&&(u.duelingQNet=e[4]),32&n&&(u.learningRate=e[5]),64&n&&(u.trainDistance=e[6]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[16](null),W(t,n)}}}function Me(e){let t,n,u,r;const s=[Ve,Re],l=[];function i(e,t){return e[3]?0:1}return t=i(e),n=l[t]=s[t](e),{c(){n.c(),u=x()},m(e,n){l[t].m(e,n),d(e,u,n),r=!0},p(e,[r]){let a=t;t=i(e),t===a?l[t].p(e,r):(G(),H(l[a],1,1,(()=>{l[a]=null})),O(),n=l[t],n?n.p(e,r):(n=l[t]=s[t](e),n.c()),q(n,1),n.m(u.parentNode,u))},i(e){r||(q(n),r=!0)},o(e){H(n),r=!1},d(e){l[t].d(e),e&&m(u)}}}function Te(e,t,n){let u,{numX:r}=t,{numY:s}=t,{numA:l}=t,{useQNet:i=!0}=t,{duelingQNet:a=!1}=t,{learningRate:o=.002}=t,{trainDistance:c=10}=t;const d=e=>u.predictState(e),m=e=>{let t=d(e);return t.indexOf(Math.max(...t))},g=e=>Math.floor(Math.random()*Math.floor(e));return e.$$set=e=>{"numX"in e&&n(0,r=e.numX),"numY"in e&&n(1,s=e.numY),"numA"in e&&n(2,l=e.numA),"useQNet"in e&&n(3,i=e.useQNet),"duelingQNet"in e&&n(4,a=e.duelingQNet),"learningRate"in e&&n(5,o=e.learningRate),"trainDistance"in e&&n(6,c=e.trainDistance)},[r,s,l,i,a,o,c,u,d,(e,t)=>d(e)[t],e=>Math.max(...d(e)),m,g,(e,t)=>Math.random()<t?g(l):m(e),()=>{u.init()},async(e,t)=>u.updateModel(e,t),function(e){D[e?"unshift":"push"]((()=>{u=e,n(7,u)}))},function(t){F(e,t)},function(e){D[e?"unshift":"push"]((()=>{u=e,n(7,u)}))},function(t){F(e,t)}]}class Be extends te{constructor(e){super(),ee(this,e,Te,Me,i,{numX:0,numY:1,numA:2,useQNet:3,duelingQNet:4,learningRate:5,trainDistance:6,getQValues:8,getQValue:9,getMaxQValue:10,getPolicy:11,getRandomInt:12,getEpsilonGreedyAction:13,init:14,updateModel:15})}get getQValues(){return this.$$.ctx[8]}get getQValue(){return this.$$.ctx[9]}get getMaxQValue(){return this.$$.ctx[10]}get getPolicy(){return this.$$.ctx[11]}get getRandomInt(){return this.$$.ctx[12]}get getEpsilonGreedyAction(){return this.$$.ctx[13]}get init(){return this.$$.ctx[14]}get updateModel(){return this.$$.ctx[15]}}function _e(e){let t,n,u={numX:e[0],numY:e[1],numA:e[2],useQNet:e[3],duelingQNet:e[4]};return t=new Be({props:u}),e[12](t),t.$on("modelChanged",e[13]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,[n]){const u={};1&n&&(u.numX=e[0]),2&n&&(u.numY=e[1]),4&n&&(u.numA=e[2]),8&n&&(u.useQNet=e[3]),16&n&&(u.duelingQNet=e[4]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[12](null),W(t,n)}}}function ze(e,t,n){let u,r,{numX:s}=t,{numY:l}=t,{numA:i}=t,{useQNet:a=!1}=t,{duelingQNet:o=!1}=t,c=0,d=0,m=!1,{envStepFunc:g=null}=t,{episodeDoneFunc:f=null}=t;const p=e=>{let t;return t=e.done?e.r:e.r+.9*r.getMaxQValue(e.stateNext),a?t:.8*r.getQValue(e.state,e.a)+.2*t},h=e=>{let t,n,s;m?f(c,d):u=setTimeout((async()=>{n=r.getEpsilonGreedyAction(e,.1),[t,s,m]=g(e,n),await r.updateModel({state:e,a:n,r:s,stateNext:t,done:m},p),e=[...t],d+=s,c++,h(e)}),0)};return e.$$set=e=>{"numX"in e&&n(0,s=e.numX),"numY"in e&&n(1,l=e.numY),"numA"in e&&n(2,i=e.numA),"useQNet"in e&&n(3,a=e.useQNet),"duelingQNet"in e&&n(4,o=e.duelingQNet),"envStepFunc"in e&&n(6,g=e.envStepFunc),"episodeDoneFunc"in e&&n(7,f=e.episodeDoneFunc)},[s,l,i,a,o,r,g,f,e=>{d=0,c=0,m=!1,h(e)},()=>{r.init()},()=>{u&&clearTimeout(u)},e=>r.getQValues(e),function(e){D[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},function(t){F(e,t)}]}class Ce extends te{constructor(e){super(),ee(this,e,ze,_e,i,{numX:0,numY:1,numA:2,useQNet:3,duelingQNet:4,envStepFunc:6,episodeDoneFunc:7,runEpisode:8,init:9,halt:10,getQValues:11})}get runEpisode(){return this.$$.ctx[8]}get init(){return this.$$.ctx[9]}get halt(){return this.$$.ctx[10]}get getQValues(){return this.$$.ctx[11]}}function Ie(e){let t,n,u={numX:e[0],numY:e[1],numA:e[2],useQNet:e[3],duelingQNet:e[4]};return t=new Be({props:u}),e[12](t),t.$on("modelChanged",e[13]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,[n]){const u={};1&n&&(u.numX=e[0]),2&n&&(u.numY=e[1]),4&n&&(u.numA=e[2]),8&n&&(u.useQNet=e[3]),16&n&&(u.duelingQNet=e[4]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[12](null),W(t,n)}}}function je(e,t,n){let u,r,{numX:s}=t,{numY:l}=t,{numA:i}=t,{useQNet:a=!1}=t,{duelingQNet:o=!1}=t,c=0,d=0,m=!1,{envStepFunc:g=null}=t,{episodeDoneFunc:f=null}=t;const p=e=>{let t;return t=e.done?e.r:e.r+.9*r.getQValue(e.stateNext,e.aNext),a?t:.8*r.getQValue(e.state,e.a)+.2*t},h=(e,t)=>{let n,s,l;m?f(c,d):u=setTimeout((async()=>{[n,l,m]=g(e,t),s=r.getEpsilonGreedyAction(n,.1),await r.updateModel({state:e,a:t,r:l,stateNext:n,aNext:s,done:m},p),e=[...n],t=Number(s),d+=l,c++,h(e,t)}),0)};return e.$$set=e=>{"numX"in e&&n(0,s=e.numX),"numY"in e&&n(1,l=e.numY),"numA"in e&&n(2,i=e.numA),"useQNet"in e&&n(3,a=e.useQNet),"duelingQNet"in e&&n(4,o=e.duelingQNet),"envStepFunc"in e&&n(6,g=e.envStepFunc),"episodeDoneFunc"in e&&n(7,f=e.episodeDoneFunc)},[s,l,i,a,o,r,g,f,e=>{d=0,c=0,m=!1;let t=r.getEpsilonGreedyAction(e,.1);h(e,t)},()=>{r.init()},()=>{u&&clearTimeout(u)},e=>r.getQValues(e),function(e){D[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},function(t){F(e,t)}]}class Le extends te{constructor(e){super(),ee(this,e,je,Ie,i,{numX:0,numY:1,numA:2,useQNet:3,duelingQNet:4,envStepFunc:6,episodeDoneFunc:7,runEpisode:8,init:9,halt:10,getQValues:11})}get runEpisode(){return this.$$.ctx[8]}get init(){return this.$$.ctx[9]}get halt(){return this.$$.ctx[10]}get getQValues(){return this.$$.ctx[11]}}function Pe(e){let t,n,u={numX:e[0],numY:e[1],numA:e[2],useQNet:e[3],duelingQNet:e[4]};return t=new Be({props:u}),e[12](t),t.$on("modelChanged",e[13]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,[n]){const u={};1&n&&(u.numX=e[0]),2&n&&(u.numY=e[1]),4&n&&(u.numA=e[2]),8&n&&(u.useQNet=e[3]),16&n&&(u.duelingQNet=e[4]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[12](null),W(t,n)}}}const Ge=.1;function Oe(e,t,n){let u,r,{numX:s}=t,{numY:l}=t,{numA:i}=t,{useQNet:a=!1}=t,{duelingQNet:o=!1}=t,c=0,d=0,m=!1,{envStepFunc:g=null}=t,{episodeDoneFunc:f=null}=t;const p=e=>{let t;if(e.done)t=e.r;else{let n,u=0;n=Ge/i;for(let t=0;t<i;t++)u+=n*r.getQValue(e.stateNext,t);n=.9;let s=r.getPolicy(e.stateNext);u+=n*r.getQValue(e.stateNext,s),t=e.r+.9*u}return a?t:.8*r.getQValue(e.state,e.a)+.2*t},h=(e,t)=>{let n,s,l;m?f(c,d):u=setTimeout((async()=>{[n,l,m]=g(e,t),s=r.getEpsilonGreedyAction(n,Ge),await r.updateModel({state:e,a:t,r:l,stateNext:n,aNext:s,done:m},p),e=[...n],t=Number(s),d+=l,c++,h(e,t)}),0)};return e.$$set=e=>{"numX"in e&&n(0,s=e.numX),"numY"in e&&n(1,l=e.numY),"numA"in e&&n(2,i=e.numA),"useQNet"in e&&n(3,a=e.useQNet),"duelingQNet"in e&&n(4,o=e.duelingQNet),"envStepFunc"in e&&n(6,g=e.envStepFunc),"episodeDoneFunc"in e&&n(7,f=e.episodeDoneFunc)},[s,l,i,a,o,r,g,f,e=>{d=0,c=0,m=!1;let t=r.getEpsilonGreedyAction(e,Ge);h(e,t)},()=>{r.init()},()=>{u&&clearTimeout(u)},e=>r.getQValues(e),function(e){D[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},function(t){F(e,t)}]}class qe extends te{constructor(e){super(),ee(this,e,Oe,Pe,i,{numX:0,numY:1,numA:2,useQNet:3,duelingQNet:4,envStepFunc:6,episodeDoneFunc:7,runEpisode:8,init:9,halt:10,getQValues:11})}get runEpisode(){return this.$$.ctx[8]}get init(){return this.$$.ctx[9]}get halt(){return this.$$.ctx[10]}get getQValues(){return this.$$.ctx[11]}}function He(e){let t,n,u={numX:e[0],numY:e[1],numA:e[2],useQNet:e[3],duelingQNet:e[4],learningRate:Je};return t=new Be({props:u}),e[13](t),t.$on("modelChanged",e[14]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,[n]){const u={};1&n&&(u.numX=e[0]),2&n&&(u.numY=e[1]),4&n&&(u.numA=e[2]),8&n&&(u.useQNet=e[3]),16&n&&(u.duelingQNet=e[4]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[13](null),W(t,n)}}}let Je=.002;function Ke(e,t,n){let u,r,{numX:s}=t,{numY:l}=t,{numA:i}=t,{useQNet:a=!1}=t,{duelingQNet:o=!1}=t,{planningSteps:c=10}=t,d=0,m=0,g=!1,{envStepFunc:f=null}=t,{episodeDoneFunc:p=null}=t;const h=e=>{let t;return t=e.done?e.r:e.r+.9*r.getMaxQValue(e.stateNext),a?t:.8*r.getQValue(e.state,e.a)+.2*t};let $=Array.from({length:s},(()=>Array.from({length:l},(()=>Array.from({length:i},(()=>null)))))),x=[];const y=()=>{let e=r.getRandomInt(x.length);return x[e]},Q=e=>{let t,n,s;g?p(d,m):u=setTimeout((async()=>{n=r.getEpsilonGreedyAction(e,.1),[t,s,g]=f(e,n),await r.updateModel({state:e,a:n,r:s,stateNext:t,done:g},h),(e=>{let t=e.state[0],n=e.state[1],u=e.a,r=!1;for(let e=0;e<x.length;e++)if(x[e][0]==t&&x[e][1]==n&&x[e][2]==u){r=!0;break}r||x.push([e.state,u]),$[t][n][u]=[e.stateNext,e.r,e.done]})({state:e,a:n,r:s,stateNext:t,done:g}),e=[...t];for(let e=0;e<c;e++){let e,t,n,u,s;[e,t]=y(),[u,n,s]=$[e[0]][e[1]][t],await r.updateModel({state:e,a:t,r:n,stateNext:u,done:s},h)}m+=s,d++,Q(e)}),0)};return e.$$set=e=>{"numX"in e&&n(0,s=e.numX),"numY"in e&&n(1,l=e.numY),"numA"in e&&n(2,i=e.numA),"useQNet"in e&&n(3,a=e.useQNet),"duelingQNet"in e&&n(4,o=e.duelingQNet),"planningSteps"in e&&n(6,c=e.planningSteps),"envStepFunc"in e&&n(7,f=e.envStepFunc),"episodeDoneFunc"in e&&n(8,p=e.episodeDoneFunc)},[s,l,i,a,o,r,c,f,p,e=>{m=0,d=0,g=!1,Q(e)},()=>{r.init()},()=>{u&&clearTimeout(u)},e=>r.getQValues(e),function(e){D[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},function(t){F(e,t)}]}class Ue extends te{constructor(e){super(),ee(this,e,Ke,He,i,{numX:0,numY:1,numA:2,useQNet:3,duelingQNet:4,planningSteps:6,envStepFunc:7,episodeDoneFunc:8,runEpisode:9,init:10,halt:11,getQValues:12})}get runEpisode(){return this.$$.ctx[9]}get init(){return this.$$.ctx[10]}get halt(){return this.$$.ctx[11]}get getQValues(){return this.$$.ctx[12]}}function We(e){let t,n,u={numX:e[0],numY:e[1],numA:e[2],useQNet:e[3],duelingQNet:e[4],learningRate:Ze};return t=new Be({props:u}),e[12](t),t.$on("modelChanged",e[13]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,[n]){const u={};1&n&&(u.numX=e[0]),2&n&&(u.numY=e[1]),4&n&&(u.numA=e[2]),8&n&&(u.useQNet=e[3]),16&n&&(u.duelingQNet=e[4]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[12](null),W(t,n)}}}let Ze=.001;function et(e,t,n){let u,r,{numX:s}=t,{numY:l}=t,{numA:i}=t,{useQNet:a=!1}=t,{duelingQNet:o=!1}=t,c=0,d=0,m=!1,{envStepFunc:g=null}=t,{episodeDoneFunc:f=null}=t;const p=e=>a?e.g:.8*r.getQValue(e.state,e.a)+.2*e.g;let h;const $=e=>{let t,n,a;m?((async()=>{for(let e=0;e<l;e++)for(let t=0;t<s;t++)for(let n=0;n<i;n++){let u=!1,s=0,l=1;for(let r=0;r<h.length;r++)t==h[r].state[0]&&e==h[r].state[1]&&n==h[r].a&&(u=!0),u&&(s+=l*h[r].r,l*=.9);if(u){let u=[t,e];await r.updateModel({state:u,a:n,g:s},p)}}})(),f(c,d)):u=setTimeout((()=>{n=r.getEpsilonGreedyAction(e,.1),[t,a,m]=g(e,n),h.push({state:e,a:n,r:a}),e=[...t],d+=a,c++,$(e)}),0)};return e.$$set=e=>{"numX"in e&&n(0,s=e.numX),"numY"in e&&n(1,l=e.numY),"numA"in e&&n(2,i=e.numA),"useQNet"in e&&n(3,a=e.useQNet),"duelingQNet"in e&&n(4,o=e.duelingQNet),"envStepFunc"in e&&n(6,g=e.envStepFunc),"episodeDoneFunc"in e&&n(7,f=e.episodeDoneFunc)},[s,l,i,a,o,r,g,f,e=>{d=0,c=0,m=!1,h=[],$(e)},()=>{r.init()},()=>{u&&clearTimeout(u)},e=>r.getQValues(e),function(e){D[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},function(t){F(e,t)}]}class tt extends te{constructor(e){super(),ee(this,e,et,We,i,{numX:0,numY:1,numA:2,useQNet:3,duelingQNet:4,envStepFunc:6,episodeDoneFunc:7,runEpisode:8,init:9,halt:10,getQValues:11})}get runEpisode(){return this.$$.ctx[8]}get init(){return this.$$.ctx[9]}get halt(){return this.$$.ctx[10]}get getQValues(){return this.$$.ctx[11]}}function nt(e,t,n){const u=e.slice();return u[40]=t[n],u}function ut(e){let n,u,r,s=e[40].name+"";return{c(){n=f("option"),u=h(s),n.__value=r=e[40].name,n.value=n.__value},m(e,t){d(e,n,t),c(n,u)},p:t,d(e){e&&m(n)}}}function rt(e){let t,n,u={numX:e[5],numY:e[6],numA:4,useQNet:e[14],duelingQNet:e[15],envStepFunc:e[18],episodeDoneFunc:e[20]};return t=new tt({props:u}),e[38](t),t.$on("modelChanged",e[19]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){const u={};32&n[0]&&(u.numX=e[5]),64&n[0]&&(u.numY=e[6]),16384&n[0]&&(u.useQNet=e[14]),32768&n[0]&&(u.duelingQNet=e[15]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[38](null),W(t,n)}}}function st(e){let t,n,u={numX:e[5],numY:e[6],numA:4,useQNet:e[14],duelingQNet:e[15],planningSteps:e[4],envStepFunc:e[18],episodeDoneFunc:e[20]};return t=new Ue({props:u}),e[37](t),t.$on("modelChanged",e[19]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){const u={};32&n[0]&&(u.numX=e[5]),64&n[0]&&(u.numY=e[6]),16384&n[0]&&(u.useQNet=e[14]),32768&n[0]&&(u.duelingQNet=e[15]),16&n[0]&&(u.planningSteps=e[4]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[37](null),W(t,n)}}}function lt(e){let t,n,u={numX:e[5],numY:e[6],numA:4,useQNet:e[14],duelingQNet:e[15],envStepFunc:e[18],episodeDoneFunc:e[20]};return t=new qe({props:u}),e[36](t),t.$on("modelChanged",e[19]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){const u={};32&n[0]&&(u.numX=e[5]),64&n[0]&&(u.numY=e[6]),16384&n[0]&&(u.useQNet=e[14]),32768&n[0]&&(u.duelingQNet=e[15]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[36](null),W(t,n)}}}function it(e){let t,n,u={numX:e[5],numY:e[6],numA:4,useQNet:e[14],duelingQNet:e[15],envStepFunc:e[18],episodeDoneFunc:e[20]};return t=new Le({props:u}),e[35](t),t.$on("modelChanged",e[19]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){const u={};32&n[0]&&(u.numX=e[5]),64&n[0]&&(u.numY=e[6]),16384&n[0]&&(u.useQNet=e[14]),32768&n[0]&&(u.duelingQNet=e[15]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[35](null),W(t,n)}}}function at(e){let t,n,u={numX:e[5],numY:e[6],numA:4,useQNet:e[14],duelingQNet:e[15],envStepFunc:e[18],episodeDoneFunc:e[20]};return t=new Ce({props:u}),e[34](t),t.$on("modelChanged",e[19]),{c(){K(t.$$.fragment)},m(e,u){U(t,e,u),n=!0},p(e,n){const u={};32&n[0]&&(u.numX=e[5]),64&n[0]&&(u.numY=e[6]),16384&n[0]&&(u.useQNet=e[14]),32768&n[0]&&(u.duelingQNet=e[15]),t.$set(u)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){H(t.$$.fragment,e),n=!1},d(n){e[34](null),W(t,n)}}}function ot(e){let t,n,u,r,l,i,a,o,p,S,b,Y,X,k,F,E,R,V,M,T,z,C,I,j,L,P,Z,ee,te,ne,ue,re,se,le,ie,ae,oe;function ce(t){e[28].call(null,t)}function de(t){e[29].call(null,t)}let me={yTitle:"reward per episode",ySecondTitle:"steps per episode",hasSecondY:!1};void 0!==e[11]&&(me.data=e[11]),void 0!==e[10]&&(me.dataSecond=e[10]),u=new we({props:me}),e[27](u),D.push((()=>J(u,"data",ce))),D.push((()=>J(u,"dataSecond",de)));let ge=e[21],fe=[];for(let t=0;t<ge.length;t+=1)fe[t]=ut(nt(e,ge,t));let pe={numX:e[5],numY:e[6],blocked:e[0],terminal:e[1],rewards:e[2],defaultReward:e[3]};ne=new Ne({props:pe}),e[33](ne);const he=[at,it,lt,st,rt],$e=[];function xe(e,t){return"Q-Learning"==e[12]?0:"SARSA"==e[12]?1:"Expected SARSA"==e[12]?2:"Dyna-Q"==e[12]?3:"Monte Carlo"==e[12]?4:-1}return~(re=xe(e))&&(se=$e[re]=he[re](e)),{c(){t=f("div"),n=f("div"),K(u.$$.fragment),i=$(),a=f("div"),o=h("EPISODE : "),p=h(e[13]),S=$(),b=f("div"),Y=f("select");for(let e=0;e<fe.length;e+=1)fe[e].c();X=$(),k=f("div"),F=f("input"),E=h("\n      DQN"),R=$(),V=f("div"),M=f("input"),T=h("\n      Dueling"),z=$(),C=f("button"),C.textContent="init",I=$(),j=f("button"),j.textContent="halt",L=$(),P=f("button"),Z=h("run"),ee=$(),te=f("div"),K(ne.$$.fragment),ue=$(),se&&se.c(),le=x(),Q(n,"class","narrow-box svelte-akg5ju"),Q(a,"class","box svelte-akg5ju"),Q(Y,"class","svelte-akg5ju"),void 0===e[12]&&B((()=>e[30].call(Y))),Q(F,"type","checkbox"),F.disabled=ct,Q(F,"class","svelte-akg5ju"),Q(k,"class","flexrow svelte-akg5ju"),w(k,"disabled",ct),Q(M,"type","checkbox"),M.disabled=e[17],Q(M,"class","svelte-akg5ju"),Q(V,"class","flexrow svelte-akg5ju"),w(V,"disabled",e[17]),Q(C,"class","svelte-akg5ju"),Q(j,"class","svelte-akg5ju"),P.disabled=e[16],Q(P,"class","svelte-akg5ju"),Q(b,"class","box svelte-akg5ju"),Q(te,"class","narrow-box svelte-akg5ju"),Q(t,"class","container svelte-akg5ju"),v(t,"width",16+100*e[5]+4*(e[5]-1)+"px")},m(r,s){d(r,t,s),c(t,n),U(u,n,null),c(t,i),c(t,a),c(a,o),c(a,p),c(t,S),c(t,b),c(b,Y);for(let e=0;e<fe.length;e+=1)fe[e].m(Y,null);A(Y,e[12]),c(b,X),c(b,k),c(k,F),F.checked=e[14],c(k,E),c(b,R),c(b,V),c(V,M),M.checked=e[15],c(V,T),c(b,z),c(b,C),c(b,I),c(b,j),c(b,L),c(b,P),c(P,Z),c(t,ee),c(t,te),U(ne,te,null),d(r,ue,s),~re&&$e[re].m(r,s),d(r,le,s),ie=!0,ae||(oe=[y(Y,"change",e[30]),y(Y,"change",e[24]),y(F,"change",e[31]),y(F,"change",e[24]),y(M,"change",e[32]),y(M,"change",e[24]),y(C,"click",e[24]),y(j,"click",e[23]),y(P,"click",e[22])],ae=!0)},p(e,n){const s={};if(!r&&2048&n[0]&&(r=!0,s.data=e[11],_((()=>r=!1))),!l&&1024&n[0]&&(l=!0,s.dataSecond=e[10],_((()=>l=!1))),u.$set(s),(!ie||8192&n[0])&&N(p,e[13]),2097152&n[0]){let t;for(ge=e[21],t=0;t<ge.length;t+=1){const u=nt(e,ge,t);fe[t]?fe[t].p(u,n):(fe[t]=ut(u),fe[t].c(),fe[t].m(Y,null))}for(;t<fe.length;t+=1)fe[t].d(1);fe.length=ge.length}2101248&n[0]&&A(Y,e[12]),16384&n[0]&&(F.checked=e[14]),0&n&&w(k,"disabled",ct),(!ie||131072&n[0])&&(M.disabled=e[17]),32768&n[0]&&(M.checked=e[15]),131072&n[0]&&w(V,"disabled",e[17]),(!ie||65536&n[0])&&(P.disabled=e[16]);const i={};32&n[0]&&(i.numX=e[5]),64&n[0]&&(i.numY=e[6]),1&n[0]&&(i.blocked=e[0]),2&n[0]&&(i.terminal=e[1]),4&n[0]&&(i.rewards=e[2]),8&n[0]&&(i.defaultReward=e[3]),ne.$set(i),(!ie||32&n[0])&&v(t,"width",16+100*e[5]+4*(e[5]-1)+"px");let a=re;re=xe(e),re===a?~re&&$e[re].p(e,n):(se&&(G(),H($e[a],1,1,(()=>{$e[a]=null})),O()),~re?(se=$e[re],se?se.p(e,n):(se=$e[re]=he[re](e),se.c()),q(se,1),se.m(le.parentNode,le)):se=null)},i(e){ie||(q(u.$$.fragment,e),q(ne.$$.fragment,e),q(se),ie=!0)},o(e){H(u.$$.fragment,e),H(ne.$$.fragment,e),H(se),ie=!1},d(n){n&&m(t),e[27](null),W(u),g(fe,n),e[33](null),W(ne),n&&m(ue),~re&&$e[re].d(n),n&&m(le),ae=!1,s(oe)}}}let ct=!1;function dt(e,t,n){let u,r,s,l,i,{blocked:a=[]}=t,{terminal:o=Array([0,0])}=t,{rewards:c=Array([0,0,1])}=t,{defaultReward:d=0}=t,{startState:m}=t,{numEpisodes:g=1e3}=t,{planningSteps:f=10}=t,{numX:p=5}=t,{numY:h=5}=t,$=[],x=[],y=0,Q=!1,N=!1,v=!1,A=!0;const w=[{name:"Q-Learning"},{name:"SARSA"},{name:"Expected SARSA"},{name:"Dyna-Q"},{name:"Monte Carlo"}],S=()=>{n(16,v=!0),i=setTimeout((()=>{if(y<g){n(13,y++,y);let e=r.getRandomStartState();m&&(e=m),u.runEpisode(e)}else n(16,v=!1)}),0)};return e.$$set=e=>{"blocked"in e&&n(0,a=e.blocked),"terminal"in e&&n(1,o=e.terminal),"rewards"in e&&n(2,c=e.rewards),"defaultReward"in e&&n(3,d=e.defaultReward),"startState"in e&&n(25,m=e.startState),"numEpisodes"in e&&n(26,g=e.numEpisodes),"planningSteps"in e&&n(4,f=e.planningSteps),"numX"in e&&n(5,p=e.numX),"numY"in e&&n(6,h=e.numY)},[a,o,c,d,f,p,h,u,r,s,$,x,l,y,Q,N,v,A,(e,t)=>r.step(e,t),()=>{for(let e=0;e<h;e++)for(let t=0;t<p;t++){let n=[t,e],s=u.getQValues(n);r.setQValues(n,s)}},(e,t)=>{$.push(e),x.push(t),s.updatePlot(),S()},w,S,()=>{i&&clearTimeout(i),u.halt(),n(16,v=!1)},()=>{n(17,A=!Q),A&&n(15,N=!1),n(13,y=0),n(10,$=[]),n(11,x=[]),s.clearPlot(),u.init()},m,g,function(e){D[e?"unshift":"push"]((()=>{s=e,n(9,s)}))},function(e){x=e,n(11,x)},function(e){$=e,n(10,$)},function(){l=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(12,l),n(21,w)},function(){Q=this.checked,n(14,Q)},function(){N=this.checked,n(15,N)},function(e){D[e?"unshift":"push"]((()=>{r=e,n(8,r)}))},function(e){D[e?"unshift":"push"]((()=>{u=e,n(7,u)}))},function(e){D[e?"unshift":"push"]((()=>{u=e,n(7,u)}))},function(e){D[e?"unshift":"push"]((()=>{u=e,n(7,u)}))},function(e){D[e?"unshift":"push"]((()=>{u=e,n(7,u)}))},function(e){D[e?"unshift":"push"]((()=>{u=e,n(7,u)}))}]}class mt extends te{constructor(e){super(),ee(this,e,dt,ot,i,{blocked:0,terminal:1,rewards:2,defaultReward:3,startState:25,numEpisodes:26,planningSteps:4,numX:5,numY:6},[-1,-1])}}const gt=document.getElementById("maze-shell-0"),ft=document.getElementById("maze-shell-1"),pt=document.getElementById("maze-shell-2"),ht=document.getElementById("maze-shell-3"),$t=document.getElementById("maze-shell-4"),xt=gt?new mt({target:gt,props:{numX:12,numY:3,planningSteps:10,blocked:Array(),terminal:Array([1,2],[2,2],[3,2],[4,2],[5,2],[6,2],[7,2],[8,2],[9,2],[10,2],[11,2]),rewards:Array([1,2,-10],[2,2,-10],[3,2,-10],[4,2,-10],[5,2,-10],[6,2,-10],[7,2,-10],[8,2,-10],[9,2,-10],[10,2,-10],[11,2,0]),defaultReward:-.1,startState:[0,2]}}):null,yt=ft?new mt({target:ft,props:{numX:7,numY:3,planningSteps:10,blocked:Array(),terminal:Array([1,2],[2,2],[3,2],[4,2],[5,2],[6,2]),rewards:Array([1,2,-10],[2,2,-10],[3,2,-10],[4,2,-10],[5,2,-10],[6,2,0]),defaultReward:-.1,startState:[0,2]}}):null,Qt=pt?new mt({target:pt,props:{numX:5,numY:5,blocked:Array(),terminal:Array([1,1]),rewards:Array([1,1,1]),defaultReward:-.1}}):null,Nt=ht?new mt({target:ht,props:{numX:5,numY:5,blocked:Array(),terminal:Array([1,1]),rewards:Array([1,1,1],[3,3,1]),defaultReward:-.1}}):null,vt=$t?new mt({target:$t,props:{numX:6,numY:4,blocked:Array([0,0],[3,2],[4,1],[3,3]),terminal:Array([1,1]),rewards:Array([1,1,1]),defaultReward:-.1}}):null;return e.comp0=xt,e.comp1=yt,e.comp2=Qt,e.comp3=Nt,e.comp4=vt,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=bundle.js.map
